{"ast":null,"code":"import api from './apiClient';\n\n// Helper function to get current user role\nconst getCurrentUserRole = () => {\n  if (typeof window !== \"undefined\" && window.localStorage) {\n    const userStr = localStorage.getItem('user');\n    if (userStr) {\n      try {\n        const user = JSON.parse(userStr);\n        // Use the role with ROLE_ prefix for backend compatibility\n        return (user === null || user === void 0 ? void 0 : user.role) || 'ROLE_EMPLOYEE';\n      } catch (e) {\n        console.error('Error parsing user from localStorage:', e);\n      }\n    }\n  }\n  return 'ROLE_EMPLOYEE';\n};\n\n// Get all users\nexport const getUsers = async () => {\n  try {\n    const userRole = getCurrentUserRole();\n\n    // Check for both ROLE_ADMIN and ADMIN (for backward compatibility)\n    if (userRole === 'ROLE_ADMIN' || userRole === 'ADMIN') {\n      // Only Admin can see all users\n      const response = await api.get('/users');\n      return response.data;\n    } else {\n      // Non-admin users shouldn't access user list\n      throw new Error('Access denied: Admin privileges required');\n    }\n  } catch (error) {\n    console.error('Error fetching users:', error);\n    throw error;\n  }\n};\n\n// Alias for consistency\nexport const getAllUsers = getUsers;\n\n// Get single user\nexport const getUser = async id => {\n  try {\n    const response = await api.get(`/users/${id}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching user:', error);\n    throw error;\n  }\n};\n\n// Create new user\nexport const createUser = async data => {\n  try {\n    const response = await api.post('/users/create', data);\n    return response.data;\n  } catch (error) {\n    console.error('Error creating user:', error);\n    throw error;\n  }\n};\n\n// Update existing user\nexport const updateUser = async (id, data) => {\n  try {\n    const response = await api.put(`/users/${id}`, data);\n    return response.data;\n  } catch (error) {\n    console.error('Error updating user:', error);\n    throw error;\n  }\n};\n\n// Delete user\nexport const deleteUser = async id => {\n  try {\n    const response = await api.delete(`/users/${id}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error deleting user:', error);\n    throw error;\n  }\n};","map":{"version":3,"names":["api","getCurrentUserRole","window","localStorage","userStr","getItem","user","JSON","parse","role","e","console","error","getUsers","userRole","response","get","data","Error","getAllUsers","getUser","id","createUser","post","updateUser","put","deleteUser","delete"],"sources":["E:/EMS/frontend/src/api/userService.js"],"sourcesContent":["import api from './apiClient';\r\n\r\n// Helper function to get current user role\r\nconst getCurrentUserRole = () => {\r\n    if (typeof window !== \"undefined\" && window.localStorage) {\r\n        const userStr = localStorage.getItem('user');\r\n        if (userStr) {\r\n            try {\r\n                const user = JSON.parse(userStr);\r\n                // Use the role with ROLE_ prefix for backend compatibility\r\n                return user?.role || 'ROLE_EMPLOYEE';\r\n            } catch (e) {\r\n                console.error('Error parsing user from localStorage:', e);\r\n            }\r\n        }\r\n    }\r\n    return 'ROLE_EMPLOYEE';\r\n};\r\n\r\n// Get all users\r\nexport const getUsers = async () => {\r\n    try {\r\n        const userRole = getCurrentUserRole();\r\n        \r\n        // Check for both ROLE_ADMIN and ADMIN (for backward compatibility)\r\n        if (userRole === 'ROLE_ADMIN' || userRole === 'ADMIN') {\r\n            // Only Admin can see all users\r\n            const response = await api.get('/users');\r\n            return response.data;\r\n        } else {\r\n            // Non-admin users shouldn't access user list\r\n            throw new Error('Access denied: Admin privileges required');\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching users:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// Alias for consistency\r\nexport const getAllUsers = getUsers;\r\n\r\n// Get single user\r\nexport const getUser = async (id) => {\r\n    try {\r\n        const response = await api.get(`/users/${id}`);\r\n        return response.data;\r\n    } catch (error) {\r\n        console.error('Error fetching user:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// Create new user\r\nexport const createUser = async (data) => {\r\n    try {\r\n        const response = await api.post('/users/create', data);\r\n        return response.data;\r\n    } catch (error) {\r\n        console.error('Error creating user:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// Update existing user\r\nexport const updateUser = async (id, data) => {\r\n    try {\r\n        const response = await api.put(`/users/${id}`, data);\r\n        return response.data;\r\n    } catch (error) {\r\n        console.error('Error updating user:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// Delete user\r\nexport const deleteUser = async (id) => {\r\n    try {\r\n        const response = await api.delete(`/users/${id}`);\r\n        return response.data;\r\n    } catch (error) {\r\n        console.error('Error deleting user:', error);\r\n        throw error;\r\n    }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}