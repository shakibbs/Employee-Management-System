{"ast":null,"code":"import api from './apiClient';\n\n// Helper function to get current user role\nconst getCurrentUserRole = () => {\n  if (typeof window !== \"undefined\" && window.localStorage) {\n    const userStr = localStorage.getItem('user');\n    if (userStr) {\n      try {\n        const user = JSON.parse(userStr);\n        return (user === null || user === void 0 ? void 0 : user.role) || 'ROLE_EMPLOYEE';\n      } catch (e) {\n        console.error('Error parsing user from localStorage:', e);\n      }\n    }\n  }\n  return 'ROLE_EMPLOYEE';\n};\n\n// Get dashboard data\nexport const getDashboardData = async () => {\n  try {\n    const userRole = getCurrentUserRole();\n    if (userRole === 'ROLE_ADMIN' || userRole === 'ROLE_HR') {\n      // Admin/HR can see full dashboard analytics\n      const response = await api.get('/analytics/dashboard');\n      return response.data;\n    } else {\n      // Employees get limited dashboard data\n      // Return basic structure that the frontend can handle\n      return {\n        employeeCount: 1,\n        // Only themselves\n        departmentCount: 1,\n        // Their department\n        attendanceStats: {\n          present: 0,\n          absent: 0,\n          leave: 0\n        },\n        recentEmployees: [],\n        recentAttendance: []\n      };\n    }\n  } catch (error) {\n    console.error('Error fetching dashboard data:', error);\n    throw error;\n  }\n};\n\n// Get employee demographics\nexport const getEmployeeDemographics = async () => {\n  try {\n    const userRole = getCurrentUserRole();\n    if (userRole === 'ROLE_ADMIN' || userRole === 'ROLE_HR') {\n      const response = await api.get('/analytics/departments');\n      return response.data;\n    } else {\n      // Employees don't have access to demographics\n      throw new Error('Access denied: Admin/HR privileges required');\n    }\n  } catch (error) {\n    console.error('Error fetching employee demographics:', error);\n    throw error;\n  }\n};\n\n// Get attendance trends\nexport const getAttendanceTrends = async () => {\n  try {\n    const userRole = getCurrentUserRole();\n    if (userRole === 'ROLE_ADMIN' || userRole === 'ROLE_HR') {\n      const response = await api.get('/analytics/attendance');\n      return response.data;\n    } else {\n      // Employees don't have access to attendance trends\n      throw new Error('Access denied: Admin/HR privileges required');\n    }\n  } catch (error) {\n    console.error('Error fetching attendance trends:', error);\n    throw error;\n  }\n};\n\n// Get payroll summary\nexport const getPayrollSummary = async () => {\n  try {\n    const userRole = getCurrentUserRole();\n    if (userRole === 'ROLE_ADMIN' || userRole === 'ROLE_HR') {\n      const response = await api.get('/analytics/payroll');\n      return response.data;\n    } else {\n      // Employees don't have access to payroll data\n      throw new Error('Access denied: Admin/HR privileges required');\n    }\n  } catch (error) {\n    console.error('Error fetching payroll summary:', error);\n    throw error;\n  }\n};","map":{"version":3,"names":["api","getCurrentUserRole","window","localStorage","userStr","getItem","user","JSON","parse","role","e","console","error","getDashboardData","userRole","response","get","data","employeeCount","departmentCount","attendanceStats","present","absent","leave","recentEmployees","recentAttendance","getEmployeeDemographics","Error","getAttendanceTrends","getPayrollSummary"],"sources":["E:/EMS/frontend/src/api/analyticsService.js"],"sourcesContent":["import api from './apiClient';\r\n\r\n// Helper function to get current user role\r\nconst getCurrentUserRole = () => {\r\n    if (typeof window !== \"undefined\" && window.localStorage) {\r\n        const userStr = localStorage.getItem('user');\r\n        if (userStr) {\r\n            try {\r\n                const user = JSON.parse(userStr);\r\n                return user?.role || 'ROLE_EMPLOYEE';\r\n            } catch (e) {\r\n                console.error('Error parsing user from localStorage:', e);\r\n            }\r\n        }\r\n    }\r\n    return 'ROLE_EMPLOYEE';\r\n};\r\n\r\n// Get dashboard data\r\nexport const getDashboardData = async () => {\r\n    try {\r\n        const userRole = getCurrentUserRole();\r\n        \r\n        if (userRole === 'ROLE_ADMIN' || userRole === 'ROLE_HR') {\r\n            // Admin/HR can see full dashboard analytics\r\n            const response = await api.get('/analytics/dashboard');\r\n            return response.data;\r\n        } else {\r\n            // Employees get limited dashboard data\r\n            // Return basic structure that the frontend can handle\r\n            return {\r\n                employeeCount: 1, // Only themselves\r\n                departmentCount: 1, // Their department\r\n                attendanceStats: { present: 0, absent: 0, leave: 0 },\r\n                recentEmployees: [],\r\n                recentAttendance: []\r\n            };\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching dashboard data:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// Get employee demographics\r\nexport const getEmployeeDemographics = async () => {\r\n    try {\r\n        const userRole = getCurrentUserRole();\r\n        \r\n        if (userRole === 'ROLE_ADMIN' || userRole === 'ROLE_HR') {\r\n            const response = await api.get('/analytics/departments');\r\n            return response.data;\r\n        } else {\r\n            // Employees don't have access to demographics\r\n            throw new Error('Access denied: Admin/HR privileges required');\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching employee demographics:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// Get attendance trends\r\nexport const getAttendanceTrends = async () => {\r\n    try {\r\n        const userRole = getCurrentUserRole();\r\n        \r\n        if (userRole === 'ROLE_ADMIN' || userRole === 'ROLE_HR') {\r\n            const response = await api.get('/analytics/attendance');\r\n            return response.data;\r\n        } else {\r\n            // Employees don't have access to attendance trends\r\n            throw new Error('Access denied: Admin/HR privileges required');\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching attendance trends:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n// Get payroll summary\r\nexport const getPayrollSummary = async () => {\r\n    try {\r\n        const userRole = getCurrentUserRole();\r\n        \r\n        if (userRole === 'ROLE_ADMIN' || userRole === 'ROLE_HR') {\r\n            const response = await api.get('/analytics/payroll');\r\n            return response.data;\r\n        } else {\r\n            // Employees don't have access to payroll data\r\n            throw new Error('Access denied: Admin/HR privileges required');\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching payroll summary:', error);\r\n        throw error;\r\n    }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}